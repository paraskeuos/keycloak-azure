apiVersion: v1
kind: Pod
metadata:
  name: nginx-proxy-pod
spec:
  containers:
    - image: docker.io/library/nginx:1.29.2
      name: nginx
      ports:
        - containerPort: {{ reverse_proxy_port }}
          hostPort: {{ reverse_proxy_port }}
      volumeMounts:
      - name: conf-vol
        mountPath: /etc/nginx/{{ reverse_proxy_config }}:Z
        readOnly: true
      - name: cert-vol
        mountPath: /etc/nginx/ssl:z
  volumes:
  - name: conf-vol
    hostPath:
      path: {{ work_dir }}/{{ reverse_proxy_config }}
      type: File
  - name: cert-vol
    hostPath:
      path: {{ host_cert_dir }}
      type: Directory
